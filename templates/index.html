{% extends "base.html" %}

{% block title %}VyOS Dashboard{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="d-flex justify-content-between align-items-center mb-2">
        <div>
            <h1 class="h3 m-0">VyOS Dashboard</h1>
            <p class="text-muted small mb-0">Configuration overview and analytics</p>
        </div>
        <span class="vyos-instance-label" id="instanceLabel">Verison 0.1.0 Alpha</span>
    </div>
    
    <!-- Loading Indicator -->
    <div id="loadingIndicator" class="text-center my-2">
        <div class="spinner-border spinner-border-sm text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
        <span class="ms-2">Loading configuration data...</span>
    </div>
    
    <!-- Error Alert -->
    <div id="errorAlert" class="alert alert-danger d-none" role="alert">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        <span>Failed to load configuration data. Please check your VyOS API connection settings.</span>
        <div class="mt-2">
            <small>Make sure your VyOS router is accessible and the API service is running.</small>
        </div>
    </div>
    
    <!-- Dashboard Content -->
    <div id="dashboardContent" class="d-none">
        <!-- Tabs Navigation -->
        <div class="nav-tabs-container mb-2">
            <ul class="nav nav-tabs" id="vyosTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview" type="button" role="tab" aria-controls="overview" aria-selected="true">
                        <i class="bi bi-grid"></i> Overview
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="network-tab" data-bs-toggle="tab" data-bs-target="#network" type="button" role="tab" aria-controls="network" aria-selected="false">
                        <i class="bi bi-diagram-3"></i> Network
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="firewall-tab" data-bs-toggle="tab" data-bs-target="#firewall" type="button" role="tab" aria-controls="firewall" aria-selected="false">
                        <i class="bi bi-shield"></i> Firewall
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="nat-tab" data-bs-toggle="tab" data-bs-target="#nat" type="button" role="tab" aria-controls="nat" aria-selected="false">
                        <i class="bi bi-arrow-left-right"></i> NAT
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="services-tab" data-bs-toggle="tab" data-bs-target="#services" type="button" role="tab" aria-controls="services" aria-selected="false">
                        <i class="bi bi-gear"></i> Services
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="system-tab" data-bs-toggle="tab" data-bs-target="#system" type="button" role="tab" aria-controls="system" aria-selected="false">
                        <i class="bi bi-cpu"></i> System
                    </button>
                </li>
            </ul>
        </div>
        
        <!-- Tab Content -->
        <div class="tab-content" id="vyosTabsContent">
            <!-- Overview Tab -->
            <div class="tab-pane fade show active" id="overview" role="tabpanel" aria-labelledby="overview-tab">
                <div class="alert alert-primary py-2" role="alert">
                    <i class="bi bi-info-circle me-2"></i> Summary of your VyOS router configuration
                </div>
                
                <!-- Stats Cards -->
                <div class="row g-2">
                    <div class="col-md-3 col-sm-6">
                        <div class="stat-card compact">
                            <div class="stat-card-header">
                                <h3>Interfaces</h3>
                                <i class="bi bi-ethernet stat-icon"></i>
                            </div>
                            <div class="stat-card-body">
                                <div class="stat-number" id="interfaceCount">--</div>
                                <div class="stat-desc">Active network interfaces</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="stat-card compact">
                            <div class="stat-card-header">
                                <h3>Firewall Rules</h3>
                                <i class="bi bi-shield-lock stat-icon"></i>
                            </div>
                            <div class="stat-card-body">
                                <div class="stat-number" id="firewallRuleCount">--</div>
                                <div class="stat-desc">Active firewall rules</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="stat-card compact">
                            <div class="stat-card-header">
                                <h3>NAT Rules</h3>
                                <i class="bi bi-arrow-left-right stat-icon"></i>
                            </div>
                            <div class="stat-card-body">
                                <div class="stat-number" id="natRuleCount">--</div>
                                <div class="stat-desc">Network address translations</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="stat-card compact">
                            <div class="stat-card-header">
                                <h3>Services</h3>
                                <i class="bi bi-gear-wide-connected stat-icon"></i>
                            </div>
                            <div class="stat-card-body">
                                <div class="stat-number" id="serviceCount">--</div>
                                <div class="stat-desc">Active network services</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Network Overview and System Info -->
                <div class="row g-2 mt-2">
                    <div class="col-md-6">
                        <div class="dashboard-card compact h-100">
                            <div class="card-header">
                                <h3>Network Overview</h3>
                            </div>
                            <div class="card-body p-2">
                                <div id="network-overview-container">
                                    <!-- Title -->
                                    <h4 class="h5 mb-3">Network Overview</h4>
                                    
                                    <!-- Internet Node -->
                                    <div class="network-overview-section">
                                        <div class="network-node internet-node">
                                            <div class="node-icon"><i class="bi bi-globe"></i></div>
                                            <div class="node-label">Internet</div>
                                            <div class="node-details" id="internetDetails">WAN: 77.90.39.96</div>
                                        </div>
                                        <div class="network-connection"></div>
                                        <div class="network-node router-node">
                                            <div class="node-icon"><i class="bi bi-hdd-network"></i></div>
                                            <div class="node-label">VyOS Router</div>
                                            <div class="node-details" id="routerDetails">vyos</div>
                                        </div>
                                        <div class="network-connection"></div>
                                        <div class="network-node lan-node">
                                            <div class="node-icon"><i class="bi bi-pc-display"></i></div>
                                            <div class="node-label">Internal Network</div>
                                            <div class="node-details" id="lanDetails">LAN: 192.168.0.1/24</div>
                                        </div>
                                    </div>
                                    
                                    <!-- Other Networks -->
                                    <div class="network-overview-other mt-4">
                                        <h4 class="h5 mb-3">Other Networks</h4>
                                        <div id="other-networks-container">
                                            <!-- Template for additional networks -->
                                            <div class="network-node other-network mb-2">
                                                <div class="d-flex align-items-center">
                                                    <div class="node-icon me-2"><i class="bi bi-diagram-3"></i></div>
                                                    <div>
                                                        <div class="node-label">Unknown</div>
                                                        <div class="node-details">eth2: 10.10.10.0.2/24</div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Additional networks will be added here by JavaScript -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="dashboard-card compact h-100">
                            <div class="card-header">
                                <h3>System Information</h3>
                            </div>
                            <div class="card-body p-2">
                                <div class="system-info-list">
                                    <div class="info-item">
                                        <span class="info-label">Hostname</span>
                                        <span class="info-value" id="hostname">--</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">WAN Interface</span>
                                        <span class="info-value" id="wanInterface">--</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">LAN Interface</span>
                                        <span class="info-value" id="lanInterface">--</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Default Gateway</span>
                                        <span class="info-value" id="defaultGateway">--</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">DHCP Server</span>
                                        <span class="info-value" id="dhcpServer">--</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">DNS Forwarding</span>
                                        <span class="info-value" id="dnsForwarding">--</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">SSH Access</span>
                                        <span class="info-value" id="sshAccess">--</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Network Tab -->
            <div class="tab-pane fade" id="network" role="tabpanel" aria-labelledby="network-tab">
                <div class="alert alert-info py-2 d-flex justify-content-between align-items-center" role="alert">
                    <div>
                        <i class="bi bi-info-circle me-2"></i> Detailed network interface configuration
                    </div>
                    <div>
                        <a href="/routing" class="btn btn-sm btn-outline-primary">
                            <i class="bi bi-diagram-3"></i> Routing Table
                        </a>
                    </div>
                </div>
                
                <!-- Network Interfaces Section -->
                <div class="dashboard-card compact mb-3">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h3>Network Interfaces</h3>
                        <span class="badge bg-primary rounded-pill" id="interfaces-count">0</span>
                    </div>
                    <div class="card-body p-2">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Interface</th>
                                        <th>Description</th>
                                        <th>IP Address</th>
                                        <th>MAC Address</th>
                                        <th>MTU</th>
                                        <th>Type</th>
                                    </tr>
                                </thead>
                                <tbody id="interfaces-table-body">
                                    <tr>
                                        <td colspan="6" class="text-center">Loading interface data...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="text-muted small mt-2 ps-2">
                            <div><i class="bi bi-diagram-3 text-info me-1"></i> <span class="badge rounded-pill vif">VIF</span> - Virtual interfaces (VLAN subinterfaces)</div>
                            <div><span class="badge rounded-pill wan">WAN</span> - External/Internet-facing interfaces (determined by "WAN", "MGMT", or "External" in description)</div>
                            <div><span class="badge rounded-pill lan">LAN</span> - Internal network interfaces (determined by "LAN" or "Local" in description)</div>
                            <div><span class="badge rounded-pill ethernet">ETHERNET</span> - General ethernet interfaces (without specific LAN/WAN designation)</div>
                        </div>
                    </div>
                </div>
                
                <!-- Network Groups Section -->
                <div class="dashboard-card compact mb-3">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h3>Network Groups</h3>
                        <span class="badge bg-primary rounded-pill" id="network-groups-count">0</span>
                    </div>
                    <div class="card-body p-2">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Group Name</th>
                                        <th>Type</th>
                                        <th>Members</th>
                                    </tr>
                                </thead>
                                <tbody id="network-groups-table-body">
                                    <tr>
                                        <td colspan="3" class="text-center">Loading network groups...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Routing Section -->
                <div class="dashboard-card compact">
                    <div class="card-header">
                        <h3>Routing Information</h3>
                    </div>
                    <div class="card-body p-2">
                        <div class="d-flex mb-3">
                            <div class="me-4">
                                <h4 class="h5">Default Gateway</h4>
                                <p class="mb-1" id="default-gateway-info">Loading...</p>
                            </div>
                            <div>
                                <h4 class="h5">Static Routes</h4>
                                <p class="mb-1" id="static-routes-count">Loading...</p>
                            </div>
                        </div>
                        
                        <div class="table-responsive" id="routes-table-container">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Destination</th>
                                        <th>Next Hop</th>
                                        <th>Distance</th>
                                    </tr>
                                </thead>
                                <tbody id="routes-table-body">
                                    <tr>
                                        <td colspan="3" class="text-center">Loading routing table...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Firewall Tab -->
            <div class="tab-pane fade" id="firewall" role="tabpanel" aria-labelledby="firewall-tab">
                <div class="alert alert-warning py-2" role="alert">
                    <i class="bi bi-info-circle me-2"></i> Firewall rules and security settings
                </div>
                
                <!-- Firewall Rules Section -->
                <div class="dashboard-card compact mb-3">
                    <div class="card-header">
                        <h3>Firewall Rules</h3>
                        <p class="text-muted small mb-0">Firewall rules controlling traffic flow</p>
                    </div>
                    <div class="card-body p-2">
                        <!-- Firewall Rules Tabs -->
                        <ul class="nav nav-tabs nav-fill mb-3" id="firewallRulesTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="input-rules-tab" data-bs-toggle="tab" data-bs-target="#input-rules" type="button" role="tab" aria-controls="input-rules" aria-selected="true">
                                    Input Rules
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="forward-rules-tab" data-bs-toggle="tab" data-bs-target="#forward-rules" type="button" role="tab" aria-controls="forward-rules" aria-selected="false">
                                    Forward Rules
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="named-rule-sets-tab" data-bs-toggle="tab" data-bs-target="#named-rule-sets" type="button" role="tab" aria-controls="named-rule-sets" aria-selected="false">
                                    Named Rule Sets
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="global-policies-tab" data-bs-toggle="tab" data-bs-target="#global-policies" type="button" role="tab" aria-controls="global-policies" aria-selected="false">
                                    Global Policies
                                </button>
                            </li>
                        </ul>
                        
                        <!-- Firewall Rules Tab Content -->
                        <div class="tab-content" id="firewallRulesTabsContent">
                            <!-- Input Rules Tab -->
                            <div class="tab-pane fade show active" id="input-rules" role="tabpanel" aria-labelledby="input-rules-tab">
                                <div class="mb-2">
                                    <h4 class="h5">Input Chain Rules</h4>
                                    <p class="small text-muted">Rules controlling traffic destined for the router itself</p>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Rule</th>
                                                <th>Action</th>
                                                <th>Details</th>
                                            </tr>
                                        </thead>
                                        <tbody id="input-rules-table-body">
                                            <tr>
                                                <td colspan="3" class="text-center">Loading input rules...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <!-- Forward Rules Tab -->
                            <div class="tab-pane fade" id="forward-rules" role="tabpanel" aria-labelledby="forward-rules-tab">
                                <div class="mb-2">
                                    <h4 class="h5">Forward Chain Rules</h4>
                                    <p class="small text-muted">Rules controlling traffic passing through the router</p>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Rule</th>
                                                <th>Action</th>
                                                <th>Details</th>
                                            </tr>
                                        </thead>
                                        <tbody id="forward-rules-table-body">
                                            <tr>
                                                <td colspan="3" class="text-center">Loading forward rules...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <!-- Named Rule Sets Tab -->
                            <div class="tab-pane fade" id="named-rule-sets" role="tabpanel" aria-labelledby="named-rule-sets-tab">
                                <div class="mb-2">
                                    <h4 class="h5">Named Rule Sets</h4>
                                    <p class="small text-muted">Custom rule chains that can be referenced by other rules</p>
                                </div>
                                <div id="named-rule-sets-container">
                                    <div class="text-center">Loading named rule sets...</div>
                                </div>
                            </div>
                            
                            <!-- Global Policies Tab -->
                            <div class="tab-pane fade" id="global-policies" role="tabpanel" aria-labelledby="global-policies-tab">
                                <div class="mb-2">
                                    <h4 class="h5">Global Firewall Policies</h4>
                                    <p class="small text-muted">Default actions for connection states</p>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Connection State</th>
                                                <th>Policy</th>
                                            </tr>
                                        </thead>
                                        <tbody id="global-policies-table-body">
                                            <tr>
                                                <td colspan="2" class="text-center">Loading global policies...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Firewall Groups Section -->
                <div class="dashboard-card compact">
                    <div class="card-header">
                        <h3>Firewall Groups</h3>
                        <p class="text-muted small mb-0">Network and interface groups used in firewall rules</p>
                    </div>
                    <div class="card-body p-2">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Group Name</th>
                                        <th>Type</th>
                                        <th>Members</th>
                                    </tr>
                                </thead>
                                <tbody id="firewall-groups-table-body">
                                    <tr>
                                        <td colspan="3" class="text-center">Loading firewall groups...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- NAT Tab -->
            <div class="tab-pane fade" id="nat" role="tabpanel" aria-labelledby="nat-tab">
                <div class="alert alert-info py-2" role="alert">
                    <i class="bi bi-info-circle me-2"></i> Network Address Translation rules
                </div>
                
                <!-- NAT Rules Section -->
                <div class="dashboard-card compact mb-3">
                    <div class="card-header">
                        <h3>NAT Rules</h3>
                        <p class="text-muted small mb-0">Network Address Translation rules</p>
                    </div>
                    <div class="card-body p-2">
                        <h4 class="h5 mb-3">Source NAT Rules</h4>
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Rule</th>
                                        <th>Source</th>
                                        <th>Outbound Interface</th>
                                        <th>Translation</th>
                                        <th>Type</th>
                                    </tr>
                                </thead>
                                <tbody id="source-nat-table-body">
                                    <tr>
                                        <td colspan="5" class="text-center">Loading source NAT rules...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <h4 class="h5 mb-3 mt-4">Destination NAT Rules</h4>
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Rule</th>
                                        <th>Destination</th>
                                        <th>Inbound Interface</th>
                                        <th>Protocol</th>
                                        <th>Translation</th>
                                    </tr>
                                </thead>
                                <tbody id="destination-nat-table-body">
                                    <tr>
                                        <td colspan="5" class="text-center">Loading destination NAT rules...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- NAT Flow Visualization Section -->
                <div class="dashboard-card compact">
                    <div class="card-header">
                        <h3>NAT Flow Visualization</h3>
                        <p class="text-muted small mb-0">Visual representation of NAT traffic flow</p>
                    </div>
                    <div class="card-body p-2">
                        <div class="nat-flow-container p-3">
                            <div class="row mb-5">
                                <div class="col-md-5">
                                    <div class="nat-network internal-network p-3">
                                        <h5>Internal Network</h5>
                                        <div id="internal-network-ip" class="network-address mb-1">192.168.0.0/24</div>
                                        <div class="network-type small text-muted">Private IP Range</div>
                                    </div>
                                </div>
                                <div class="col-md-2 d-flex align-items-center justify-content-center">
                                    <div class="flow-arrow">
                                        <i class="bi bi-arrow-right fs-1"></i>
                                    </div>
                                </div>
                                <div class="col-md-5">
                                    <div class="nat-network external-network p-3">
                                        <h5>External Network</h5>
                                        <div id="external-network-ip" class="network-address mb-1">77.90.39.119/24</div>
                                        <div class="network-type small text-muted">Public IP</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="nat-translation-box p-4 mb-3">
                                <h4 class="text-center mb-3">NAT Translation</h4>
                                <div id="nat-translation-type" class="text-center mb-2">Source Address Translation (Masquerade)</div>
                                <div id="nat-translation-detail" class="text-center small">Internal clients appear as 77.90.39.119 to external servers</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Services Tab -->
            <div class="tab-pane fade" id="services" role="tabpanel" aria-labelledby="services-tab">
                <h4 class="mb-3">Network services and applications</h4>
                
                <!-- Nav Pills -->
                <ul class="nav nav-pills mb-4" id="servicesTabContent" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="dhcp-tab" data-bs-toggle="pill" data-bs-target="#dhcp" type="button" role="tab">
                            <i class="fas fa-network-wired"></i> DHCP
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="dns-tab" data-bs-toggle="pill" data-bs-target="#dns" type="button" role="tab">
                            <i class="fas fa-globe"></i> DNS
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="bgp-tab" data-bs-toggle="pill" data-bs-target="#bgp" type="button" role="tab">
                            <i class="fas fa-project-diagram"></i> BGP
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="ntp-tab" data-bs-toggle="pill" data-bs-target="#ntp" type="button" role="tab">
                            <i class="far fa-clock"></i> NTP
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="ssh-tab" data-bs-toggle="pill" data-bs-target="#ssh" type="button" role="tab">
                            <i class="fas fa-terminal"></i> SSH
                        </button>
                    </li>
                </ul>
                
                <!-- Tab Content -->
                <div class="tab-content" id="servicesTabContent">
                    <!-- DHCP Tab -->
                    <div class="tab-pane fade show active" id="dhcp" role="tabpanel" aria-labelledby="dhcp-tab">
                        <div class="service-card">
                            <div class="service-header">
                                <div>
                                    <h5>
                                        <i class="fas fa-network-wired"></i> DHCP Server
                                        <span class="badge bg-success ms-2">Active</span>
                                    </h5>
                                    <div class="service-description">Dynamic Host Configuration Protocol server settings</div>
                                </div>

                            </div>
                            
                            <div class="service-body">
                                <div class="service-search">
                                    <div class="input-group">
                                        <input type="text" class="form-control" placeholder="Search networks or subnets..." id="dhcpSearch">
                                        <button type="button" class="btn btn-primary">
                                            <i class="fas fa-search"></i> Search
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- DHCP Status Panel -->
                                <div id="dhcp-status" class="d-none"></div>
                                
                                <!-- DHCP Config Section -->
                                <div id="dhcp-config">
                                    <div class="network-list" id="dhcp-networks">
                                        <!-- Networks will be populated by JavaScript -->
                                        <div class="text-center py-4">
                                            <div class="spinner-border text-primary" role="status">
                                                <span class="visually-hidden">Loading...</span>
                                            </div>
                                            <p class="mt-2 text-muted">Loading DHCP configuration...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- DNS Tab -->
                    <div class="tab-pane fade" id="dns" role="tabpanel" aria-labelledby="dns-tab">
                        <div class="service-card">
                            <div class="service-header">
                                <div>
                                    <h5>
                                        <i class="fas fa-globe"></i> DNS Service
                                        <span class="badge bg-success ms-2">Active</span>
                                    </h5>
                                    <div class="service-description">Domain Name System configuration and settings</div>
                                </div>
                                <button class="refresh-button" id="refreshDns">
                                    <i class="fas fa-sync-alt"></i> Refresh
                                </button>
                            </div>
                            
                            <div class="service-body">
                                <div class="service-search">
                                    <div class="input-group">
                                        <input type="text" class="form-control" placeholder="Search DNS entries..." id="dnsSearch">
                                        <button type="button" class="btn btn-primary">
                                            <i class="fas fa-search"></i> Search
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- DNS Status Section -->
                                <div id="dns-status">
                                    <div class="text-center py-4">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Loading...</span>
                                        </div>
                                        <p class="mt-2 text-muted">Loading DNS configuration...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- BGP Tab -->
                    <div class="tab-pane fade" id="bgp" role="tabpanel" aria-labelledby="bgp-tab">
                        <div class="service-card">
                            <div class="service-header">
                                <div>
                                    <h5>
                                        <i class="fas fa-project-diagram"></i> BGP Service
                                        <span class="badge bg-success ms-2">Active</span>
                                    </h5>
                                    <div class="service-description">Border Gateway Protocol configuration</div>
                                </div>
                                <button class="refresh-button" id="refreshBgp">
                                    <i class="fas fa-sync-alt"></i> Refresh
                                </button>
                            </div>
                            
                            <div class="service-body">
                                <div class="network-list" id="bgp-config">
                                    <div class="text-center py-4">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Loading...</span>
                                        </div>
                                        <p class="mt-2 text-muted">Loading BGP configuration...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- NTP Tab -->
                    <div class="tab-pane fade" id="ntp" role="tabpanel" aria-labelledby="ntp-tab">
                        <div class="service-card">
                            <div class="service-header">
                                <div>
                                    <h5>
                                        <i class="far fa-clock"></i> NTP Service
                                        <span class="badge bg-success ms-2">Active</span>
                                    </h5>
                                    <div class="service-description">Network Time Protocol configuration</div>
                                </div>
                                <button class="refresh-button" id="refreshNtp">
                                    <i class="fas fa-sync-alt"></i> Refresh
                                </button>
                            </div>
                            
                            <div class="service-body">
                                <div class="network-list" id="ntp-config">
                                    <div class="text-center py-4">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Loading...</span>
                                        </div>
                                        <p class="mt-2 text-muted">Loading NTP configuration...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- SSH Tab -->
                    <div class="tab-pane fade" id="ssh" role="tabpanel" aria-labelledby="ssh-tab">
                        <div class="service-card">
                            <div class="service-header">
                                <div>
                                    <h5>
                                        <i class="fas fa-terminal"></i> SSH Service
                                        <span class="badge bg-success ms-2">Active</span>
                                    </h5>
                                    <div class="service-description">Secure Shell server configuration</div>
                                </div>
                                <button class="refresh-button" id="refreshSsh">
                                    <i class="fas fa-sync-alt"></i> Refresh
                                </button>
                            </div>
                            
                            <div class="service-body">
                                <div class="network-list" id="ssh-config">
                                    <div class="text-center py-4">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Loading...</span>
                                        </div>
                                        <p class="mt-2 text-muted">Loading SSH configuration...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- System Tab -->
            <div class="tab-pane fade" id="system" role="tabpanel" aria-labelledby="system-tab">
                <div class="alert alert-info py-2" role="alert">
                    <i class="bi bi-info-circle me-2"></i> General system configuration and settings
                </div>
                
                <!-- System Information -->
                <div class="dashboard-card compact mb-3">
                    <div class="card-header">
                        <h3><i class="bi bi-gear-fill me-2"></i> System Information</h3>
                        <p class="text-muted small mb-0">General system configuration and settings</p>
                    </div>
                    <div class="card-body p-2">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="info-item">
                                    <span class="info-label">Hostname</span>
                                    <span class="info-value" id="system-hostname">---</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Config Management</span>
                                    <span class="info-value" id="system-config-management">---</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="info-item">
                                    <span class="info-label">Console Speed</span>
                                    <span class="info-value" id="system-console-speed">---</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- User Accounts -->
                <div class="dashboard-card compact mb-3">
                    <div class="card-header">
                        <h3><i class="bi bi-person-fill me-2"></i> User Accounts</h3>
                        <p class="text-muted small mb-0">System user configuration</p>
                    </div>
                    <div class="card-body p-2">
                        <div id="user-accounts-list">
                            <!-- User accounts will be populated here -->
                            <div class="text-center py-3">
                                <div class="spinner-border spinner-border-sm text-primary" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                                <span class="ms-2">Loading user accounts...</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Connection Tracking -->
                <div class="dashboard-card compact mb-3">
                    <div class="card-header">
                        <h3><i class="bi bi-arrow-left-right me-2"></i> Connection Tracking</h3>
                        <p class="text-muted small mb-0">Connection tracking modules</p>
                    </div>
                    <div class="card-body p-2">
                        <div id="connection-tracking-modules" class="row g-3">
                            <!-- Connection tracking modules will be populated dynamically based on enabled protocols -->
                            <div class="text-center py-3 w-100" id="connection-tracking-loader">
                                <div class="spinner-border spinner-border-sm text-primary" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                                <span class="ms-2">Loading connection tracking modules...</span>
                            </div>
                            
                            <!-- Protocol Template (hidden) -->
                            <div class="col-md-2 col-sm-4 col-6 protocol-template d-none">
                                <div class="protocol-card text-center p-3">
                                    <div class="protocol-icon mb-2">
                                        <i class="bi bi-diagram-3"></i>
                                    </div>
                                    <div class="protocol-name">Protocol</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="/static/js/main.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        initDashboard();
        
        // Initialize configuration logging toggle state
        const configLoggingToggle = document.querySelector('.logging-toggle-container input');
        if (configLoggingToggle) {
            configLoggingToggle.checked = localStorage.getItem('configLoggingEnabled') === 'true';
            updateLoggingVisuals(configLoggingToggle.checked);
        }
    });
    
    function updateLoggingVisuals(enabled) {
        const toggleContainer = document.querySelector('.logging-toggle-container');
        if (toggleContainer) {
            toggleContainer.classList.toggle('enabled', enabled);
        }
    }
</script>
{% endblock %} 